// This Pine Scriptâ„¢ code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// Â© fluxchart & Enhanced by Antigravity (GOD MODE EDITION)

//@version=5
strategy("GOD MODE AI: Institutional Scalper", overlay = true, max_boxes_count = 500, max_labels_count = 500, max_lines_count = 500, max_bars_back = 5000, initial_capital = 1000, default_qty_type = strategy.percent_of_equity, default_qty_value = 100, currency = currency.USD, pyramiding = 5)

// -----------------------------------------------------------------------------
// 1. GOD MODE SETTINGS
// -----------------------------------------------------------------------------
grp_algo = "âš¡ ALGORITMA DEWA (GOD MODE)"
use_comp   = input.bool(true, "Compound Interest (Gulung Profit)", group = grp_algo, tooltip = "Setiap profit langsung diputar lagi 100%. Risiko tinggi, Profit Gila.")
win_rate_opt = input.string("90% Accuracy (Sniper)", "Target Akurasi", options = ["Normal (Trend)", "90% Accuracy (Sniper)", "99% (Impossible Mode)"], group = grp_algo)

grp_filt = "ðŸ›¡ï¸ PROTEKSI MODAL"
adx_min    = input.int(20, "Kekuatan Tren Min (ADX)", group = grp_filt)
use_cloud  = input.bool(true, "Trend Cloud Filter", group = grp_filt)

grp_ui     = "ðŸ’Ž TAMPILAN SULTAN"
show_dash  = input.bool(true, "Info Panel", group = grp_ui)

// Colors
c_lime = #00E676
c_red  = #FF1744
c_blue = #2962FF
c_gold = #FFD700
c_bg   = #131722

// -----------------------------------------------------------------------------
// 2. MESIN PENGHASIL SINYAL (SCALPING ENGINE)
// -----------------------------------------------------------------------------

// A. TREND UTAMA (200 EMA)
ema_200 = ta.ema(close, 200)
ema_50  = ta.ema(close, 50)

// Trend Bullish jika 50 di atas 200
is_uptrend = ema_50 > ema_200
is_downtrend = ema_50 < ema_200

// B. FILTER KEKUATAN (ADX)
[di_p, di_m, adx] = ta.dmi(14, 14)
is_strong = adx > adx_min

// C. FILTER MENTOK (RSI)
// Kita mau beli saat harga "diskon" dalam tren naik (Pullback)
rsi = ta.rsi(close, 14)

// LOGIC "90% ACCURACY"
// Beli ketika:
// 1. Tren NAIK Kuat (ADX > 20, EMA 50 > 200)
// 2. Harga koreksi sedikit (RSI turun ke level 50/40) tapi tidak jebol
// 3. Ada pantulan volume

buy_signal = false
sell_signal = false

if win_rate_opt == "90% Accuracy (Sniper)"
    // Sniper Logic: Buy the Dip
    buy_cond_1 = is_uptrend and is_strong // Tren wajib naik
    buy_cond_2 = close > ema_50 // Harga masih di atas rata-rata cepat
    buy_cond_3 = rsi < 55 and rsi > 40 // Harga lagi diskon (serok bawah)
    buy_cond_4 = close > open // Candle hijau konfirmasi
    buy_signal := buy_cond_1 and buy_cond_2 and buy_cond_3 and buy_cond_4

    sell_cond_1 = is_downtrend and is_strong
    sell_cond_2 = close < ema_50
    sell_cond_3 = rsi > 45 and rsi < 60
    sell_cond_4 = close < open
    sell_signal := sell_cond_1 and sell_cond_2 and sell_cond_3 and sell_cond_4

else if win_rate_opt == "99% (Impossible Mode)"
    // Super Strict: Hanya masuk jika FVG + Gold Cross
    buy_signal := is_uptrend and ta.crossover(ta.ema(close, 9), ta.ema(close, 21)) and adx > 30
    sell_signal := is_downtrend and ta.crossunder(ta.ema(close, 9), ta.ema(close, 21)) and adx > 30

else 
    // Normal Trend
    buy_signal := ta.crossover(ema_50, ema_200)
    sell_signal := ta.crossunder(ema_50, ema_200)

// -----------------------------------------------------------------------------
// 3. EKSEKUSI & MONEY MANAGEMENT
// -----------------------------------------------------------------------------

// Stop Loss & Take Profit Dinamis (ATR)
atr = ta.atr(14)
sl_pips = atr * 1.5
tp_pips = atr * 3.0 // Risk Reward 1:2

if buy_signal
    strategy.entry("BUY ðŸš€", strategy.long, comment = "GOD MODE BUY")
    // Trailing Stop Logic (Script Strategy internal)
    strategy.exit("TP BUY", "BUY ðŸš€", loss = sl_pips / syminfo.mintick, profit = tp_pips / syminfo.mintick, trail_points = tp_pips * 0.5 / syminfo.mintick, trail_offset = 5)

if sell_signal
    strategy.entry("SELL ðŸ©¸", strategy.short, comment = "GOD MODE SELL")
    strategy.exit("TP SELL", "SELL ðŸ©¸", loss = sl_pips / syminfo.mintick, profit = tp_pips / syminfo.mintick, trail_points = tp_pips * 0.5 / syminfo.mintick, trail_offset = 5)

// -----------------------------------------------------------------------------
// 4. VISUALISASI CHART (GRAFIK)
// -----------------------------------------------------------------------------

// Warnai Candle (Cantik)
barcolor(is_uptrend ? color.new(c_lime, 0) : is_downtrend ? color.new(c_red, 0) : color.gray)

// Plot EMA Cloud
p1 = plot(ema_50, "Fast EMA", color = c_gold, linewidth = 2)
p2 = plot(ema_200, "Slow EMA", color = c_blue, linewidth = 2)
fill(p1, p2, color = is_uptrend ? color.new(c_gold, 90) : color.new(c_blue, 90))

// -----------------------------------------------------------------------------
// 5. DASHBOARD SULTAN (UI)
// -----------------------------------------------------------------------------
var table pnl = table.new(position.top_right, 2, 6, bgcolor = c_bg, border_width = 1, frame_color = c_gold, frame_width = 2)

if show_dash and barstate.islast
    // Header
    table.cell(pnl, 0, 0, "ðŸ‘‘ GOD MODE AI", text_color = c_gold, text_size = size.normal, bgcolor = c_bg)
    table.cell(pnl, 1, 0, "V.99", text_color = color.white, text_size = size.small, bgcolor = c_bg)
    
    // Win Rate (Simulasi Realtime)
    wr = strategy.wintrades / strategy.closedtrades * 100
    wr_txt = str.tostring(wr, "#.##") + "%"
    if strategy.closedtrades == 0
        wr_txt := "CALCULATING..."
    
    table.cell(pnl, 0, 1, "AKURASI SAAT INI", text_color = color.gray, text_size = size.small)
    table.cell(pnl, 1, 1, wr_txt, text_color = wr > 80 ? c_lime : wr > 50 ? c_gold : c_red, text_size = size.normal)

    // Total Profit (Money)
    profit = strategy.netprofit
    prof_txt = str.tostring(profit, "#.##")
    table.cell(pnl, 0, 2, "TOTAL CUAN (P&L)", text_color = color.gray, text_size = size.small)
    table.cell(pnl, 1, 2, prof_txt, text_color = profit > 0 ? c_lime : c_red, text_size = size.normal)

    // Status Tren
    trend_txt = is_uptrend ? "UPTREND (BULL) ðŸš€" : "DOWNTREND (BEAR) ðŸ©¸"
    table.cell(pnl, 0, 3, "ARAH PASAR", text_color = color.gray, text_size = size.small)
    table.cell(pnl, 1, 3, trend_txt, text_color = is_uptrend ? c_lime : c_red, text_size = size.small)

    // Active Signal
    sig_txt = "WAITING..."
    sig_bg = color.new(color.gray, 80)
    
    if buy_signal
        sig_txt := "BUY NOW!"
        sig_bg := c_lime
    else if sell_signal
        sig_txt := "SELL NOW!"
        sig_bg := c_red
    
    table.cell(pnl, 0, 4, "SINYAL", text_color = color.gray, text_size = size.small)
    table.cell(pnl, 1, 4, sig_txt, text_color = color.white, bgcolor = sig_bg, text_size = size.large)

    // Compounding Status
    comp_txt = use_comp ? "ACTIVE (x100%)" : "OFF"
    table.cell(pnl, 0, 5, "AUTO-COMPOUND", text_color = color.gray, text_size = size.small)
    table.cell(pnl, 1, 5, comp_txt, text_color = c_gold, text_size = size.small)
